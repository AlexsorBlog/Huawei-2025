<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Device Data Overview</title>
    <script src="tailwind-cdn.js"></script>
    <!-- 
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
-->
    <style>
            @font-face {
        font-family: 'Inter';
        font-style: normal;
        font-weight: 400;
        src: url('fonts/Inter_18pt-Regular.ttf') format('truetype');
        }

        @font-face {
        font-family: 'Inter';
        font-style: normal;
        font-weight: 500;
        src: url('fonts/Inter_18pt-Medium.ttf') format('truetype');
        }

        @font-face {
        font-family: 'Inter';
        font-style: normal;
        font-weight: 600;
        src: url('fonts/Inter_18pt-SemiBold.ttf') format('truetype');
        }

        @font-face {
        font-family: 'Inter';
        font-style: normal;
        font-weight: 700;
        src: url('fonts/Inter_18pt-Bold.ttf') format('truetype');
        }

        body {
            font-family: 'Inter', sans-serif;
        }
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #2f3136;
        }
        ::-webkit-scrollbar-thumb {
            background: #202225;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #18191c;
        }
        /* Scrollbar style for the new file menu */
        #file-list::-webkit-scrollbar {
            width: 6px;
        }
        #file-list::-webkit-scrollbar-track {
            background: #292b2f; /* Scrollbar background */
            border-radius: 3px;
        }
        #file-list::-webkit-scrollbar-thumb {
            background: #40444B; /* Handle */
            border-radius: 3px;
        }
        #file-list::-webkit-scrollbar-thumb:hover {
            background: #52575f;
        }
        
        /* Styles for file list items */
        .file-item {
            display: flex;
            align-items: center;
            justify-content: space-between; /* Pushes export icon to the right */
            padding: 0.5rem 0.75rem; /* 8px 12px */
            border-radius: 0.375rem; /* 6px */
            cursor: pointer;
            color: #b9bbbe; /* 'text-gray-400' */
            margin-bottom: 0.25rem; /* 4px */
            transition: background-color 0.2s ease;
        }
        .file-item:hover {
            background-color: #3a3d44;
            color: #ffffff;
        }
        .file-item.active {
            background-color: #40444B;
            color: #ffffff;
            font-weight: 500;
        }

        /* New: Container for the icon and text */
        .file-item-main {
            display: flex;
            align-items: center;
            overflow: hidden; /* To truncate text */
            flex-grow: 1; /* Allow it to grow */
            min-width: 0; /* Fix for flexbox overflow */
        }
        
        .file-item svg {
            width: 1.125rem; /* 18px */
            height: 1.125rem; /* 18px */
            margin-right: 0.75rem; /* 12px */
            flex-shrink: 0;
        }
        .file-item span {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /* New: Style for the export button */
        .file-export-btn {
            flex-shrink: 0;
            margin-left: 0.5rem; /* 8px */
            padding: 0.25rem; /* 4px */
            border-radius: 0.25rem; /* 4px */
            color: #b9bbbe; /* 'text-gray-400' */
            transition: background-color 0.2s ease, color 0.2s ease;
        }
        .file-export-btn:hover {
            background-color: #5865F2; /* Discord purple */
            color: #ffffff;
        }
        .file-export-btn svg {
            width: 1rem; /* 16px */
            height: 1rem; /* 16px */
            margin-right: 0; /* Override icon margin */
        }


        /* * STYLES FOR DYNAMIC CONTENT (from renderer.js)
         */

        /* Section headers (accordion) */
        #json-output h2 {
            font-size: 1.5rem; /* 24px */
            font-weight: 700;
            color: #ffffff;
            margin-top: 1.5rem; /* 24px */
            margin-bottom: 0; /* No margin bottom */
            padding: 0.75rem 0.75rem 0.75rem 2rem; /* 12px 12px 12px 32px */
            border-bottom-width: 1px;
            border-color: #40444B;
            cursor: pointer;
            position: relative;
            background-color: #2f3136;
            border-radius: 0.5rem 0.5rem 0 0; /* Rounded top only */
            transition: background-color 0.2s ease;
        }
        
        #json-output h2:hover {
            background-color: #3a3d44;
        }

        /* Arrow icon for accordion */
        #json-output h2::before {
            content: 'â–¼';
            position: absolute;
            left: 0.75rem; /* 12px */
            top: 50%;
            transform: translateY(-50%) rotate(0deg);
            font-size: 0.8em;
            transition: transform 0.2s ease-in-out;
            color: #b9bbbe;
        }

        /* Style for collapsed header */
        #json-output h2.collapsed {
             border-radius: 0.5rem; /* Rounded all sides */
             margin-bottom: 1rem; /* Margin bottom when collapsed */
        }

        #json-output h2.collapsed::before {
            transform: translateY(-50%) rotate(-90deg);
        }

        /* Collapsible content (tables) */
        .collapsible-content {
            overflow: hidden;
            transition: max-height 0.3s ease-out, visibility 0.3s ease-out;
            max-height: 5000px; /* Large enough value */
            visibility: visible;
             border-bottom-left-radius: 0.5rem;
             border-bottom-right-radius: 0.5rem;
             margin-bottom: 1rem; /* Margin bottom when expanded */
        }
        
        .collapsible-content.collapsed {
            max-height: 0;
            visibility: hidden;
            margin-bottom: 0;
        }

        /* Table wrapper (for shadow and bottom radius) */
        .table-wrapper {
             background-color: #2f3136;
             box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
             border-bottom-left-radius: 0.5rem;
             border-bottom-right-radius: 0.5rem;
             overflow: hidden; /* Clips table corners */
        }

        /* General table styles */
        .data-table {
            width: 100%;
            margin-bottom: 0; 
            border-radius: 0;
            border-collapse: collapse; /* Ensure borders are clean */
        }

        /* Headers for structured tables (wide-cols) */
        .data-table.wide-cols thead th {
            background-color: #202225;
            color: #b9bbbe;
            font-size: 0.75rem;
            text-transform: uppercase;
            padding: 0.75rem 1.5rem;
            text-align: left;
        }
        
        /* Headers (keys) for Key-Value tables */
        .data-table:not(.wide-cols) th {
            background-color: #202225;
            color: #ffffff;
            font-weight: 500;
            padding: 0.75rem 1.5rem;
            text-align: left;
            width: 30%;
            text-transform: capitalize;
            border-bottom: 1px solid #40444B;
        }

        /* Data cells */
        .data-table td {
            padding: 0.75rem 1.5rem;
            border-top: 1px solid #40444B;
            color: #dcddde;
            word-break: break-word;
        }
        
        /* Alternating rows for Key-Value tables */
        .data-table:not(.wide-cols) tr:nth-child(even) th,
        .data-table:not(.wide-cols) tr:nth-child(even) td {
             background-color: #32353B;
        }
        
        /* No top border for first row */
        .data-table tr:first-child td,
        .data-table:not(.wide-cols) tr:first-child th {
            border-top: none;
        }
        
        /* No bottom border for last row (Key-Value) */
        .data-table:not(.wide-cols) tr:last-child th,
        .data-table:not(.wide-cols) tr:last-child td {
             border-bottom: none;
        }

        /* Hover rows for structured tables */
        .data-table.wide-cols tbody tr:hover {
            background-color: #3a3d44;
        }
        
        /* Protocol Grid Styles */
        .protocol-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
            gap: 1rem;
            background-color: #2f3136;
            padding: 1rem;
            border-bottom-left-radius: 0.5rem;
            border-bottom-right-radius: 0.5rem;
        }
        .protocol-card {
            background-color: #202225;
            border-radius: 0.5rem;
            overflow: hidden;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            display: flex;
            flex-direction: column;
        }
        .protocol-card-header {
            font-size: 1rem;
            font-weight: 600;
            color: #ffffff;
            background-color: #292b2f;
            padding: 0.5rem 1rem;
            border-bottom: 1px solid #40444B;
        }
        .protocol-card-content {
            overflow-y: auto;
            max-height: 300px; /* Limit height and allow scroll */
        }
        .protocol-card-content::-webkit-scrollbar { width: 6px; }
        .protocol-card-content::-webkit-scrollbar-track { background: #202225; }
        .protocol-card-content::-webkit-scrollbar-thumb { background: #40444B; border-radius: 3px; }
        .protocol-card-content::-webkit-scrollbar-thumb:hover { background: #52575f; }
        
        /* Minimal table for protocol cards */
        .data-table.minimal th, .data-table.minimal td {
            padding: 0.5rem 1rem;
            font-size: 0.875rem;
            border-top: 1px solid #2f3136;
        }
        .data-table.minimal th {
            width: 40%;
            background-color: transparent;
            color: #b9bbbe;
            font-weight: 400;
            text-transform: none;
            border-bottom: none;
        }
        .data-table.minimal tr:nth-child(even) th,
        .data-table.minimal tr:nth-child(even) td {
             background-color: #292b2f;
        }


        /* HIGHLIGHTING STYLES */
        .critical {
            color: #f04747; /* 'text-red-400' */
            font-weight: 700;
        }
        tr.critical {
             background-color: #4f3136;
             border-color: #f04747;
        }
        tr.critical:hover {
            background-color: #5a3a41;
        }
        .up {
            color: #43b581; /* 'text-green-400' */
            font-weight: 500;
        }
        .down {
            color: #f04747; /* 'text-red-400' */
            font-weight: 500;
        }
    </style>
</head>
<body class="bg-[#36393f] text-[#dcddde]">

    <div class="flex h-screen">
        <!-- Sidebar for buttons -->
        <aside class="w-72 bg-[#2f3136] p-6 flex flex-col flex-shrink-0">
            <h1 class="text-2xl font-bold text-white mb-8">JSON/Log Parser</h1>
            <div class="mb-6 flex-shrink-0">
                <h2 class="text-sm font-semibold text-gray-400 uppercase tracking-wider mb-2">Working mode</h2>
                <div id="mode-toggle" class="flex bg-[#202225] rounded-lg p-1 text-sm font-medium">
                    
                    <button id="mode-file" data-mode="file" 
                            class="flex-1 text-center py-1.5 rounded-md transition-colors duration-150 
                                bg-[#5865F2] text-white shadow-md">
                        File
                    </button>
                    
                    <button id="mode-folder" data-mode="directory" 
                            class="flex-1 text-center py-1.5 rounded-md transition-colors duration-150 
                                text-gray-400 hover:bg-[#2f3136]">
                        Dir
                    </button>
                </div>
            </div>
    
            <div class="flex-shrink-0">

                <button id="json-file-input" class="flex items-center justify-center w-full bg-[#5865F2] hover:bg-[#4752C4] text-white font-semibold py-1 px-4 rounded-md transition-colors duration-200 mb-4 cursor-pointer">
                    <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l-4 4-4-4M6 16l-4-4 4-4"></path></svg>
                    Parse JSON
                </button>

                <button id="log-file-input" class="flex items-center justify-center w-full bg-green-600 hover:bg-green-700 text-white font-semibold py-1 px-4 rounded-md transition-colors duration-200 mb-4 cursor-pointer">
                    <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>
                    Parse TXT/LOG
                </button>

                <button id="xlsx-file-input" class="flex items-center justify-center w-full bg-gray-600 hover:bg-gray-700 text-white font-semibold py-1 px-4 rounded-md transition-colors duration-200 mb-4 cursor-pointer">
                    <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg>
                    Export to XLSX
                </button>
            </div>

            <!-- *** DEVICE MENU *** -->
            <div id="file-list-container" class="mt-4 pt-4 border-t border-gray-700 flex-grow overflow-hidden flex flex-col" style="display: none;"> <!-- Hidden by default -->
                <h2 class="text-sm font-semibold text-gray-400 uppercase tracking-wider mb-3">Devices</h2>
                <div id="file-list" class="flex-grow overflow-y-auto pr-2">
                    <!-- File items will be injected here by renderer.js -->
                </div>
            </div>
            <!-- *** END DEVICE MENU *** -->


            <!-- Footer (pinned to bottom) -->
            <div class="mt-auto flex-shrink-0 bg-[#292b2f] p-4 rounded-lg text-center">
                 <p class="text-sm text-gray-400">@ Huawey 2025 Challenge (c)</p>
            </div>
        </aside>

        <!-- Main content -->
        <main class="flex-1 p-8 overflow-y-auto">
            <div class="header">
                <h1 id="device-title" class="text-3xl font-bold text-white mb-6">Device Data Overview</h1>
            </div>

            <div id="json-output">
                <div class="bg-[#2f3136] p-6 rounded-lg shadow-lg">
                    <p class="text-lg">Please upload a JSON or log file to visualize using the buttons on the left.</p>
                </div>
            </div>
        </main>
    </div>
    
    <!-- Load renderer script -->
    <script src="renderer-new.js"></script>
</body>
</html>